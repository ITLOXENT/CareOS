# CareOS Global Rules

These rules apply to every change in this repository.

## Outcome
Build a production-grade healthcare workflow platform (CareOS) with:
- apps/api (Django + DRF + Celery)
- apps/web-admin (Next.js staff/admin)
- apps/web-portal (Next.js patient/caregiver portal)
- apps/mobile (React Native iOS/Android)
- infra/terraform (AWS IaC)
- shared packages (SDK/types)
- CI quality gates and security scanning

## Hard Quality Rules
- No placeholders. No TODO. No "stub". No "mock only". No silent fallbacks.
- Every endpoint must be functional end-to-end and covered by at least one verification step.
- If an external dependency cannot be integrated in MVP, implement a production-safe simulator:
  - Same interface and data contracts
  - Explicitly marked as simulator mode via configuration
  - Full audit trail, deterministic behavior
  - Fails closed in production unless explicitly enabled by configuration
- Never reduce security to make something work.

## Change Discipline
- Keep diffs minimal. Do not refactor unrelated code.
- Do not rename/reshape public interfaces without updating all clients and docs.
- No broad exception handling. Catch specific exceptions only and handle them explicitly.

## Multi-Tenancy (Non-negotiable)
- Every persistent domain model is tenant-scoped unless explicitly public.
- Every ORM query must enforce tenant scope.
- Every API endpoint must enforce RBAC and object-level access checks.

## Audit and Evidence
- All writes that change business state must generate an AuditEvent.
- Sensitive data must be redacted in logs and audit entries where required.
- Evidence artifacts required by compliance mapping must be generated by real code paths, not manual edits.

## Verification Required
Every change must include:
- Commands to run locally
- Acceptance checks
- CI-compatible steps

If checks fail, fix until they pass.

## Health AI Safety
- AI features are assistive only: suggest/draft/check completeness.
- No diagnosis. No medical advice.
- No AI output becomes authoritative without human approval and audit trail.

## Documentation Required
If a change impacts:
- auth, tenancy, permissions, audit logging, notifications, AI, or integrations
then update the relevant docs under docs/ accordingly.
